---
title: 함수형 프로그래밍 시작하기 (5)
tags: FP
key: post-hello-fp-5
---

### 다형성 (Polymorphism)

다형성은 하나의 인터페이스에서 다양한 타입의 개체를 제공하거나<br>
하나의 심볼로 여러 타입을 표현하는 것을 일컫습니다.<br>
가장 잘 알려진 다형성은 다음과 같습니다.<br>
```
- Subtype Polymorphism (or inclusion Polymorphism), 이하 서브타입 다형성
    - ex) override (상속)
- Parametric Polymorphism, 이하 매개변수 다형성
    - ex) Generic
- Ad-hoc Polymorphism, 이하 애드혹 다형성
    - ex) overloading, type casting
```
위와 같이 다양한 다형성이 존재하며, OOP 언어들은 여러 형태로 이를 지원하고 있습니다.<br>
그렇다면 함수형 언어는 어떨까요?<br>

---

대표적인 함수형 언어인 하스켈을 예로 들어보겠습니다.<br>
하스켈은 크게 `매개변수 다형성`과 애드혹 다형성의 일종인 `타입 클래스를 이용한 다형성`을 제공합니다.<br>
하스켈에서 매개변수 다형성은 타입 변수라는 도구를 활용하여 구체 타입을 대신합니다.<br>
```
f :: a -> a -> a
```
`::`는 타입 어노테이션 이라고 하는 것으로, f라는 심볼의 타입이 a -> a -> a 임을 나타내고 있습니다.<br>
여기서 a는 타입 변수 입니다. 임의의 타입을 나타내는 것으로, 영문 소문자라면 어떤 기호도 타입변수가 될 수 있습니다.<br>
이렇게 정의된 타입은 함수를 호출하는 쪽에 타입을 선택할 권한을 제공합니다.<br>
함수를 호출하는 쪽에서 선택한 타입이 무엇이든 다 만족시켜 줄 것이라는 약속을 제공하는 것 입니다.<br>
<br>
하스켈에서 다형 함수의 구현은 기존 OOP 언어들 과는 다릅니다.<br>
하스켈은 자바의 instanceOf와 같은 연산자를 제공하지 않습니다.<br>
OOP 언어들은 상속구조에 따른 다형성 제공을 위해 vtable 등 여러 방법을 통해 타입 정보를 저장합니다.<br>
그리고 런타임에 이들을 조회하여 다형적 처리를 수행합니다.<br>
반면 하스켈과 같은 함수형 언어들은 모든 다형적 함수에 대해 컴파일 타임에 호출해야 할 함수가 무엇인지 결정하고,<br>
이후 모든 타입 정보를 제거하는 `타입 이레이즈(type erase)`를 수행합니다.<br>
(함수형 언어의 구현에 따라 엄격하게 모두 제거해버리거나, 일부 허용하는 경우도 있다.)<br>
하지만 위의 예시와 같은 타입 선언만으로는 어떤 타입을 제공 받게 될지, 어떤 연산이 가능할 지에 대해 알 수가 없습니다.<br>
instanceOf 와 같은 연산자도 없으니 어떻게 해야할지 더욱 막막할 것 입니다.<br>
하스켈에서 이런 정보를 제공하기 위해 사용하는 것이 바로 타입클래스(type class)입니다.<br>
```
(+) :: Num a => a -> a -> a
show :: Show a => a -> String
```
위의 예시는 하스켈에서 제공하는 기본 함수들 입니다. (프렐류드 함수라고도 한다.)<br>
여기에서 `Num a =>` 나 `Show a =>`가 바로 `타입 클래스 제약(type class constraint)`을 기술하는 것 입니다.<br>
<br>
`타입 클래스`는 자바의 인터페이스와 같은 것으로 타입이 구현해야 할 연산의 정의와 기본 구현을 가지고 있습니다.<br>
특정 타입이 어떤 연산이 가능하게 만들기 위해서는 타입 클래스를 구현해야 하며, 이를 타입클래스 인스턴스를 생성한다고 합니다.<br>
이렇게 인스턴스화 된 타입들은 함수에 전달되어 컴파일 타임에 타입 추론을 통해 수행해야 할 구현을 결정의 힌트를 제공합니다.<br>
위의 타입 어노테이션으로 다시 돌아와서 `Num a =>` 나 `Show a =>` 는 타입 클래스 Num 이나<br>
Show의 인스턴스인 타입 a에 대해 함수가 균일한 동작을 보장함을 나타내고 있습니다.<br>
<br>
타입 클래스를 인터페이스와 비교하긴 했으나 더 일반적이고 유연합니다.<br>
타입 파라미터가 여러개인 경우 자바의 인터페이스의 경우 서브 타이핑의 특징으로 인해 복잡한 구현을 필요로 합니다.<br>
두개의 인자가 동일한 타입임을 구조적으로 보장할 수 없기 때문에, 런타임에 타입 검사 하는 등 여러 복잡한 절차가 필요하기 때문입니다.<br>
타입 클래스를 사용하면 인자가 되는 타입은 반드시 타입 클래스의 연산을 구현해야 하며<br>
최소한의 구현 만으로 많은 구현을 제공하기 위해 타입 클래스는 재귀적으로 구성된 디폴트 구현을 제공하고 있기도 합니다.<br>
또한 이렇게 생성된 구현은 컴파일 타임에 선택되어 프로그램에 필요한 구현 만을 담습니다.<br>
<br>
지금까지 함수형 언어에서의 다형성에 대해 대략적으로 알아보았습니다.<br>
다음에 다시 다형성을 다룰때에는 실제 코드와 함께 심도 있는 내용과 함께하도록 하겠습니다.<br>
<br>
To be continue..<br>

